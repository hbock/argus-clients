# 
#  Argus Client Software. Tools to read, analyze and manage Argus data.
#  Copyright (c) 2000-2008 QoSient, LLC
#  All rights reserved.
# 
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2, or (at your option)
#  any later version.
# 
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
# 
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  */
# 
# 

CC = @CC@

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@

DEFS = @DEFS@
LIBS = @LIBS@
WRAPLIBS = @WRAPLIBS@

CFLAGS = -g
LDFLAGS = -g

prefix = @prefix@
exec_prefix = @exec_prefix@
datarootdir = @datarootdir@

srcdir = @srcdir@
docdir = @datadir@/doc/argus-clients-3.0

#### End of system configuration section. ####

SHELL = /bin/sh

DIRS = ./common ./clients ./ragraph ./ratop ./radium ./radump @ARGUS_MYSQL@
INSTDIRS = ./clients ./radium

DISTFILES = COPYING CREDITS ChangeLog INSTALL MANIFEST Makefile.in README VERSION \
	include lib man support aclocal.m4 config configure configure.in .threads \
	bin clients common ragraph ratop radium doc radump ramysql lib/argus-clients.spec 

.c.o:
	$(CC) -c $(CPPFLAGS) $(DEFS) $(CFLAGS) $<

.PHONY: install installdirs

all: force
	@for i in  $(DIRS) ; do \
		if [ -d $$i ] ; then \
		echo "making in $$i"; \
		cd $$i; \
		$(MAKE); \
		cd ..; \
		fi; \
	done

.PHONY: all

clients: common
ratop: common
radium: common
radump: common

install:  force
	$(MAKE) installdirs
	[ -d $(DESTDIR)@prefix@ ] || \
		(mkdir -p $(DESTDIR)@prefix@; chmod 755 $(DESTDIR)@prefix@)
	[ -d $(DESTDIR)@bindir@ ] || \
		(mkdir -p $(DESTDIR)@bindir@; chmod 755 $(DESTDIR)@bindir@)
	[ -d $(DESTDIR)$(exec_prefix)/argus ] || \
		(mkdir -p $(DESTDIR)$(exec_prefix)/argus; chmod 755 $(DESTDIR)$(exec_prefix)/argus)
	[ -d $(DESTDIR)$(exec_prefix)/argus/lib ] || \
		(mkdir -p $(DESTDIR)$(exec_prefix)/argus/lib; chmod 755 $(DESTDIR)$(exec_prefix)/argus/lib)
	[ -d $(DESTDIR)$(exec_prefix)/argus/archive ] || \
		(mkdir -p $(DESTDIR)$(exec_prefix)/argus/archive; chmod 755 $(DESTDIR)$(exec_prefix)/argus/archive)
	@for i in  $(INSTDIRS) ; do \
		if [ -d $$i ] ; then \
		echo "making in $$i"; \
		cd $$i; \
		$(MAKE) install; \
		cd ..; \
		fi; \
	done
	$(INSTALL) -m 0644 $(srcdir)/support/Config/rarc $(DESTDIR)$(prefix)/argus
	$(INSTALL) -m 0644 $(srcdir)/support/Config/delegated-ipv4-latest $(DESTDIR)$(prefix)/argus
	$(INSTALL) -m 0755 $(srcdir)/bin/argusbug $(DESTDIR)@bindir@/argusbug
	[ -d $(DESTDIR)@mandir@ ] || \
		(mkdir -p $(DESTDIR)@mandir@; chmod 755 $(DESTDIR)@mandir@)
	[ -d $(DESTDIR)@mandir@/man1 ] || \
		(mkdir -p $(DESTDIR)@mandir@/man1; chmod 755 $(DESTDIR)@mandir@/man1)
	$(INSTALL) -m 0644 $(srcdir)/man/man1/ra.1 \
		$(DESTDIR)@mandir@/man1/ra.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/rabins.1 \
		$(DESTDIR)@mandir@/man1/rabins.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/racluster.1 \
		$(DESTDIR)@mandir@/man1/racluster.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/racount.1 \
		$(DESTDIR)@mandir@/man1/racount.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/ragraph.1 \
		$(DESTDIR)@mandir@/man1/ragraph.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/rahisto.1 \
		$(DESTDIR)@mandir@/man1/rahisto.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/rasort.1 \
		$(DESTDIR)@mandir@/man1/rasort.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/rasplit.1 \
		$(DESTDIR)@mandir@/man1/rasplit.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/rastream.1 \
		$(DESTDIR)@mandir@/man1/rastream.1
	$(INSTALL) -m 0644 $(srcdir)/man/man1/rastrip.1 \
		$(DESTDIR)@mandir@/man1/rastrip.1
	[ -d $(DESTDIR)@mandir@/man5 ] || \
		(mkdir -p $(DESTDIR)@mandir@/man5; chmod 755 $(DESTDIR)@mandir@/man5)
	[ -d $(DESTDIR)@mandir@/man8 ] || \
		(mkdir -p $(DESTDIR)@mandir@/man8; chmod 755 $(DESTDIR)@mandir@/man8)
	$(INSTALL) -m 0644 $(srcdir)/man/man5/rarc.5 \
		$(DESTDIR)@mandir@/man5/rarc.5
	$(INSTALL) -m 0644 $(srcdir)/man/man5/racluster.5 \
		$(DESTDIR)@mandir@/man5/racluster.5
	$(INSTALL) -m 0644 $(srcdir)/man/man5/radium.conf.5 \
		$(DESTDIR)@mandir@/man5/radium.conf.5
	$(INSTALL) -m 0644 $(srcdir)/man/man8/radium.8 \
		$(DESTDIR)@mandir@/man8/radium.8

install-doc:
	$(MAKE) installdirs
	[ -d $(DESTDIR)@prefix@ ] || \
		(mkdir -p $(DESTDIR)@prefix@; chmod 755 $(DESTDIR)@prefix@)
	[ -d $(DESTDIR)$(docdir) ] || \
		(mkdir -p $(DESTDIR)$(docdir); chmod 755 $(DESTDIR)$(docdir))
	[ -d $(DESTDIR)$(docdir)/html ] || \
		(mkdir -p $(DESTDIR)$(docdir)/html; chmod 755 $(DESTDIR)$(docdir)/html)
	[ -d $(DESTDIR)$(docdir)/html/man ] || \
		(mkdir -p $(DESTDIR)$(docdir)/html/man; chmod 755 $(DESTDIR)$(docdir)/html/man)
	$(INSTALL) -m 0644 $(srcdir)/doc/CHANGES $(DESTDIR)$(docdir)
	$(INSTALL) -m 0644 $(srcdir)/doc/FAQ $(DESTDIR)$(docdir)
	$(INSTALL) -m 0644 $(srcdir)/doc/HOW-TO $(DESTDIR)$(docdir)
	$(INSTALL) -m 0644 $(srcdir)/doc/html/man/*.html $(DESTDIR)$(docdir)/html/man
	$(INSTALL) -m 0644 $(srcdir)/README $(DESTDIR)$(docdir)
	$(INSTALL) -m 0644 $(srcdir)/COPYING $(DESTDIR)$(docdir)

uninstall:
	rm -f $(DESTDIR)@bindir@/ra
	rm -f $(DESTDIR)@bindir@/rabins
	rm -f $(DESTDIR)@bindir@/racluster
	rm -f $(DESTDIR)@bindir@/racount
	rm -f $(DESTDIR)@bindir@/radump
	rm -f $(DESTDIR)@bindir@/ragraph
	rm -f $(DESTDIR)@bindir@/rahisto
	rm -f $(DESTDIR)@bindir@/rasort
	rm -f $(DESTDIR)@bindir@/rasplit
	rm -f $(DESTDIR)@bindir@/rastream
	rm -f $(DESTDIR)@bindir@/rastrip
	rm -f $(DESTDIR)@bindir@/ratop
	rm -f $(DESTDIR)@bindir@/radium
	rm -f $(DESTDIR)@mandir@/man1/ra.1
	rm -f $(DESTDIR)@mandir@/man1/rabins.1
	rm -f $(DESTDIR)@mandir@/man1/racluster.1
	rm -f $(DESTDIR)@mandir@/man1/racount.1
	rm -f $(DESTDIR)@mandir@/man1/ragraph.1
	rm -f $(DESTDIR)@mandir@/man1/rahisto.1
	rm -f $(DESTDIR)@mandir@/man1/rasort.1
	rm -f $(DESTDIR)@mandir@/man1/rasplit.1
	rm -f $(DESTDIR)@mandir@/man1/rastream.1
	rm -f $(DESTDIR)@mandir@/man1/rastrip.1
	rm -f $(DESTDIR)@mandir@/man5/rarc.5
	rm -f $(DESTDIR)@mandir@/man5/racluster.5
	rm -f $(DESTDIR)@mandir@/man5/radium.conf.5
	rm -f $(DESTDIR)@mandir@/man8/radium.8
	rm -rf $(DESTDIR)$(docdir)
	rm -f $(DESTDIR)$(prefix)/argus/COPYING
	rm -f $(DESTDIR)$(prefix)/argus/README
	rm -f $(DESTDIR)$(prefix)/argus/rarc

installdirs:
	${srcdir}/config/mkinstalldirs $(bindir) $(infodir)

Makefile: Makefile.in config.status
	$(SHELL) config.status

config.status: configure
	$(srcdir)/configure --no-create

TAGS: $(SRCS)
	etags $(SRCS)

.PHONY: clean mostlyclean distclean realclean dist

clean: force
	rm -f config.log
	@for i in $(DIRS) ; do \
		if [ -d $$i ] ; then \
		cd $$i; \
		$(MAKE) clean; \
		cd ..; \
		fi; \
	done

mostlyclean: clean

distclean: clean
	rm -f config.*
	rm -f TAGS
	rm -f lib/*.a
	rm -f include/config.h
	rm -f include/tm.h
	rm -f bin/ra*
	rm -f Makefile
	@for i in $(DIRS) ; do \
		if [ -d $$i ] ; then \
		cd $$i; \
		$(MAKE) clean; \
		rm -f Makefile; \
		cd ..; \
		fi; \
	done

clobber realclean: force
	rm -f TAGS
	rm -f lib/*.a
	rm -f include/config.h
	rm -f include/tm.h
	rm -f bin/ra*
	rm -rf log
	@for i in $(DIRS) ; do \
		if [ -d $$i ] ; then \
		cd $$i; \
		$(MAKE) clean; \
		rm -f Makefile; \
		cd ..; \
		fi; \
	done
	rm -f ./Makefile config.*

dist: $(DISTFILES) distclean
	echo argus-clients-`cat VERSION` > .fname
	rm -rf `cat .fname`
	mkdir `cat .fname`
	tar cf - $(DISTFILES) | (cd `cat .fname`; tar xpf -)
	ls -lR `cat .fname` | fgrep CVS: | sed 's/:$///' > exfile
	tar -X exfile -chozf `cat .fname`.tar.gz `cat .fname`
	rm -rf `cat .fname` .fname exfile

force:  /tmp
depend: $(GENSRC) force
	@for i in $(DIRS) ; do \
		if [ -d $$i ] ; then \
		cd $$i; \
		$(MAKE) depend; \
		cd ..; \
		fi; \
	done

# Prevent GNU make v3 from overflowing arg limit on SysV.
.NOEXPORT:
